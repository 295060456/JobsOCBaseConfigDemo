#import <UIKit/UIKit.h>
#import <objc/runtime.h>
#import "NSObject+CurrentDevice.h"
#import "NSObject+RichText.h"
#import "UITextField+Extend.h"
#import "LoadingImage.h"
#import "MacroDef_Cor.h"

@interface ZYTextField : UITextField
#pragma mark ‚Äî‚Äî Ëá™ÂÆö‰πâÂ±ûÊÄß
@property(nonatomic,assign)CGFloat TFRiseHeight; /// ÈîÆÁõòÂú®Ê≠§ÊâãÊú∫‰∏äÁöÑÊúÄÈ´òÂºπËµ∑ÔºåÂå∫Âà´‰∫éÂÖ®Èù¢Â±èÁªìÂêàÈùûÂÖ®Èù¢Â±èÔºåÊúâ‰∏Ä‰∏™ÂÆâÂÖ®Âå∫Âüü34
@property(nonatomic,assign)CGFloat offset; /// ÂÖâÊ†áÁöÑËµ∑ÂßãË∑ùÁ¶ªË∑ùÁ¶ªÊéß‰ª∂ÊúÄÂ∑¶Ëæπ(‰∏çÂåÖÊã¨leftView)ÁöÑÂ∑ÆÂÄº
@property(nonatomic,assign)CGFloat leftViewOffsetX; /// leftView Ë∑ùÁ¶ªÊéß‰ª∂ÊúÄÂ∑¶ËæπÁöÑÂ∑ÆÂÄº
@property(nonatomic,assign)CGFloat rightViewOffsetX; /// TextFieldÁöÑÂà†Èô§ÊåâÈíÆË∑ùÁ¶ªÊéß‰ª∂ÊúÄÂè≥ËæπÁöÑÂ∑ÆÂÄº
@property(nonatomic,assign)CGFloat fieldEditorOffset; /// Âõ†‰∏∫ËÆæÁΩÆ‰∫ÜleftViewÂêéfieldEditorÊâÄÈúÄÁöÑÂÅèÁßªÈáè
@property(nonatomic,assign)NSTextAlignment placeHolderAlignment; /// PlaceHolderÁöÑ‰ΩçÁΩÆÔºàÂ∑¶/‰∏≠/Âè≥Ôºâ
@property(nonatomic,assign)CGFloat placeHolderOffset; /// Â∑¶/Âè≥/Â±Ö‰∏≠ ÂØπÈΩêÁöÑÊó∂ÂÄôÁöÑÂÅèÁßªÈáè ‰º†Ê≠£ÂÄº
@property(nonatomic,assign)CGFloat ZYTextFieldCornerRadius;
@property(nonatomic,assign)CGFloat ZYTextFieldBorderWidth;
@property(nonatomic,assign)UIColor *ZYTextFieldBorderColor;
@property(nonatomic,assign)BOOL ZYTextFieldMasksToBounds;
@property(nonatomic,assign)BOOL isShowDelBtn;/// ÊòØÂê¶ÊòæÁ§∫Âà†Èô§ÊåâÈíÆÔºåÈªòËÆ§‰∏çÊòæÁ§∫
@property(nonatomic,assign)BOOL useCustomClearButton;/// ÊòØÂê¶‰ΩøÁî®Ëá™ÂÆö‰πâÁöÑÂà†Èô§ÊåâÈíÆ ÈªòËÆ§‰∏ç‰ΩøÁî®
@property(nonatomic,assign)BOOL isShowMenu; /// ÊòØÂê¶ÊòæÁ§∫ËèúÂçï ÈªòËÆ§‰∏çÊòæÁ§∫
#pragma mark ‚Äî‚Äî Sys ‰ª•‰∏ãÂ±ûÊÄßÁöÑ‰ºòÂÖàÁ∫ßÊúÄÈ´òÔºåÂàÜÂà´ÂØπÂ∫î‰∫ÜÁ≥ªÁªü‰∏≠ÁöÑÂêÑËá™ÁöÑÊñπÊ≥ïÂêç
@property(nonatomic,assign)CGRect clearButtonRectForBounds;/// ÈáçÁΩÆclearButton‰ΩçÁΩÆ üò≠
@property(nonatomic,assign)CGRect borderRectForBounds;/// ÈáçÁΩÆËæπÁºòÂå∫Âüü  üò≠
@property(nonatomic,assign)CGRect drawPlaceholderInRect;/// Placeholder‰ΩçÁΩÆ „ÄêÂàùÂßãÂåñÁöÑÊó∂ÂÄôË∞ÉÁî®„Äëü•∂ÂíåplaceholderRectForBoundsÊúâ‰ªÄ‰πàÂå∫Âà´Ôºü
@property(nonatomic,assign)CGRect leftViewRectForBounds;/// leftView‰ΩçÁΩÆ „ÄêÈîÆÁõòÂºπËµ∑‰ºöË∞ÉÁî®Ê≠§ÊñπÊ≥ïÔºå‰ΩÜÊòØÈîÆÁõòËêΩ‰∏ãÂéª‰∏ç‰ºöË∞ÉÁî®„Äë‚ù§Ô∏è
@property(nonatomic,assign)CGRect rightViewRectForBounds;/// rightView‰ΩçÁΩÆ „ÄêÈîÆÁõòÂºπËµ∑‰ºöË∞ÉÁî®Ê≠§ÊñπÊ≥ïÔºå‰ΩÜÊòØÈîÆÁõòËêΩ‰∏ãÂéª‰∏ç‰ºöË∞ÉÁî®„Äë‚ù§Ô∏è
@property(nonatomic,assign)CGRect placeholderRectForBounds;/// PlaceholderÂå∫Âüü „ÄêÈîÆÁõòÂºπËµ∑‰ºöË∞ÉÁî®Ê≠§ÊñπÊ≥ïÔºå‰ΩÜÊòØÈîÆÁõòËêΩ‰∏ãÂéª‰∏ç‰ºöË∞ÉÁî®„Äë‚ù§Ô∏è UITextFieldLabelÁöÑÈ´òÂ∫¶ÔºåÂç≥ÊâøËΩΩplaceholderÁöÑÊéß‰ª∂ÁöÑÈ´òÂ∫¶
@property(nonatomic,assign)CGRect textRectForBounds;/// ÈáçÁΩÆÊñáÂ≠óÂå∫Âüü ÔºåËøô‰πüÊòØÁªìÊùüÁºñËæëÁöÑÊó∂ÂÄôÁöÑÊñáÂ≠óÂå∫Âüü „ÄêÊú™ÁºñËæëÁä∂ÊÄÅ‰∏ãÂÖâÊ†áÁöÑËµ∑Âßã‰ΩçÁΩÆ„Äë„ÄêÈîÆÁõòÂºπËµ∑+ËêΩ‰∏ã‰ºöË∞ÉÁî®Ê≠§ÊñπÊ≥ï„Äë‚ù§Ô∏è‚ù§Ô∏èËøô‰∏™Â±ûÊÄßÂÜ≥ÂÆöÊâøËΩΩtextÁöÑÊéß‰ª∂UITextLayoutFragmentViewÁöÑÁà∂Êéß‰ª∂UITextLayoutCanvasViewÂíåUITouchPassthroughViewÁöÑFram„ÄÇÂõæÂ±ÇÁªìÊûÑÁî±‰∏äËá≥‰∏ãÊòØÔºöUITextLayoutFragmentView‚Äî>UITextLayoutCanvasView‚Äî>UITouchPassthroughView„ÄÇÂÖ∂xÂíåyÈÉΩÊòØ0ÔºåÊñáÊú¨Ë∂ÖËøáËøô‰∏™size‰ºö‰ª•...ÁöÑÂΩ¢ÂºèÂá∫Áé∞„ÄÇtextRectForBoundsÁöÑÈ´òÂ∫¶Ëøá‰∫éÂ∞èÂ∞±‰ºöÂØºËá¥UITextLayoutFragmentViewÂä†ËΩΩ‰∏çÂà∞ÂõæÂ±Ç„ÄÇ‰∏ÄËà¨ËøôÈáåÁöÑÊúÄÂêé‰∏Ä‰∏™ÂèÇÊï∞ÔºàÈ´òÂ∫¶ÔºåÂõ∫ÂÆöÂÜôÊ≠ª100Ôºå‰∏çË¶ÅÊúâ‰ªª‰ΩïÊØî‰æãÂ∞∫Ôºâ
@property(nonatomic,assign)CGRect editingRectForBounds;/// ÈáçÁΩÆÁºñËæëÂå∫Âüü„ÄêÁºñËæëÁä∂ÊÄÅ‰∏ãÁöÑËµ∑Âßã‰ΩçÁΩÆ„Äë„ÄÅUIFieldEditorÁöÑ‰ΩçÁΩÆÂ§ßÂ∞è„ÄêÈîÆÁõòÂºπËµ∑+ËêΩ‰∏ã‰ºöË∞ÉÁî®Ê≠§ÊñπÊ≥ï„Äë‚ù§Ô∏è‚ù§Ô∏èËøô‰∏™ÂÄºÔºå‰∏ÄËà¨ == textRectForBounds„ÄÇÂΩìË∂ÖËøáËæìÂÖ•Ë∑ùÁ¶ªÁöÑÊó∂ÂÄôÔºåÊñ∞ËæìÂÖ•ÁöÑÂ≠óÁ¨¶‰ºöÂ∞Ü‰πãÂâçÁöÑÂ≠óÁ¨¶ÂæÄÂ∑¶ËæπÈ°∂

@end

/**
 ËøáÊª§Â≠óÁ¨¶ËØ∑ÁªìÂêàRACÔºåÊòØÁõÆÂâçÁöÑÊúÄ‰ºòËß£
 
 @jobs_weakify(self)
 [_textField jobsTextFieldEventFilterBlock:^BOOL(id data) {
//            @jobs_strongify(self)
     return YES;
 } subscribeNextBlock:^(NSString * _Nullable x) {
     @jobs_strongify(self)
     self.textField.text = x;
     [self textFieldBlock:self.textField
           textFieldValue:x];
 }];
*/

/** rightView
 -(ZYTextField *)textField{
     if (!_textField) {
         _textField = ZYTextField.new;
         _textField.delegate = self;
         _textField.textColor = JobsBlackColor;
         _textField.backgroundColor = RGBA_COLOR(245, 245, 245, 1);
         _textField.returnKeyType = UIReturnKeyDefault;
         _textField.keyboardAppearance = UIKeyboardAppearanceDefault;
         _textField.keyboardType = UIKeyboardTypeDefault;
         _textField.rightView = self.titleLab;
         _textField.rightViewMode = UITextFieldViewModeAlways;
         _textField.placeholder = Internationalization(@"ÊâìËµèÁöÑMataÂÄº");
         _textField.placeholderColor = JobsCor(@"#333333");
         _textField.placeholderFont = UIFontWeightRegularSize(12);

         _textField.drawPlaceholderInRect = CGRectMake(0, 0, JobsWidth(255 - 20 - 40 - 5), JobsWidth(32));
         _textField.rightViewRectForBounds = CGRectMake(JobsWidth(255 - 20 - 40), JobsWidth(10), JobsWidth(40), JobsWidth(12));
         _textField.placeholderRectForBounds = CGRectMake(JobsWidth(10), JobsWidth(10), JobsWidth(255 - 20 - 40 - 5), JobsWidth(12));
         _textField.textRectForBounds = CGRectMake(JobsWidth(10), 0, JobsWidth(255 - 20 - 40 - 10), 100);
         _textField.editingRectForBounds = CGRectMake(JobsWidth(10), 0, JobsWidth(255 - 20 - 40 - 10), 100);

         @jobs_weakify(self)
         [_textField jobsTextFieldEventFilterBlock:^BOOL(id data) {
 //            @jobs_strongify(self)
             return YES;
         } subscribeNextBlock:^(NSString * _Nullable x) {
             @jobs_strongify(self)
             self.textField.text = x;
             [self textFieldBlock:self.textField
                   textFieldValue:x];
         }];
         [_textField cornerCutToCircleWithCornerRadius:JobsWidth(8)];
         [self addSubview:_textField];
         [_textField mas_makeConstraints:^(MASConstraintMaker *make) {
             make.size.mas_equalTo(CGSizeMake(JobsWidth(255), JobsWidth(32)));
             make.centerX.equalTo(self);
             make.top.equalTo(self.titleView.mas_bottom).offset(JobsWidth(10));
         }];
     }return _textField;
 }
 */

/**
 Âè™Êúâ leftViewÔºåÂè≥Ëæπ‰ªÄ‰πà‰πüÊ≤°Êúâ
 -(ZYTextField *)textField{
     if (!_textField) {
         _textField = ZYTextField.new;
         _textField.delegate = self;
         _textField.textColor = JobsBlackColor;
         _textField.backgroundColor = JobsCor(@"#F9F9F9");
         _textField.returnKeyType = UIReturnKeyDefault;
         _textField.keyboardAppearance = UIKeyboardAppearanceDefault;
         _textField.keyboardType = UIKeyboardTypeDefault;
         _textField.leftView = [UIImageView.alloc initWithImage:self.viewModel.image];
         _textField.leftViewMode = UITextFieldViewModeAlways;
         _textField.placeholder = self.viewModel.textModel.text;
         _textField.font = UIFontWeightRegularSize(14);
         _textField.placeholderFont = _textField.font;
         _textField.placeholderColor = JobsGrayColor;
         CGFloat placeholderHeight = [self jobsGetLabelWidthWithTitle:_textField.placeholder font:_textField.placeholderFont].height;
         CGFloat placeholderY = (JobsWidth(28) - placeholderHeight) / 2;
         _textField.drawPlaceholderInRect = CGRectMake(JobsWidth(52), placeholderY, [MSInputStyle1View viewSizeWithModel:nil].width - JobsWidth(32), JobsWidth(28));// OK
         _textField.editingRectForBounds = CGRectMake(JobsWidth(52), 0, [MSInputStyle1View viewSizeWithModel:nil].width - JobsWidth(32 + 12), JobsWidth(28));
         _textField.textRectForBounds = CGRectMake(JobsWidth(52), 0, [MSInputStyle3View viewSizeWithModel:nil].width - JobsWidth(32 + 12 + 100), 100);
         @jobs_weakify(self)
         [_textField jobsTextFieldEventFilterBlock:^BOOL(id data) {
 //            @jobs_strongify(self)
             return YES;
         } subscribeNextBlock:^(NSString * _Nullable x) {
             @jobs_strongify(self)
             [self textFieldBlock:self->_textField
                   textFieldValue:x];
         }];
         [self addSubview:_textField];
         [_textField mas_makeConstraints:^(MASConstraintMaker *make) {
             make.size.mas_equalTo(CGSizeMake([MSInputStyle1View viewSizeWithModel:nil].width - JobsWidth(32 + 12), JobsWidth(28)));
             make.centerY.equalTo(self);
             make.left.equalTo(self).offset(JobsWidth(12));
         }];
     }return _textField;
 }
Âè™ÊúâleftViewÔºåÂè≥ËæπÊúâ‰∏™Ëé∑ÂèñÈ™åËØÅÁ†Å
 -(ZYTextField *)textField{
     if (!_textField) {
         _textField = ZYTextField.new;
         _textField.delegate = self;
         _textField.textColor = JobsBlackColor;
         _textField.backgroundColor = JobsCor(@"#F9F9F9");
         _textField.returnKeyType = UIReturnKeyDefault;
         _textField.keyboardAppearance = UIKeyboardAppearanceDefault;
         _textField.keyboardType = UIKeyboardTypeDefault;
         _textField.leftView = [UIImageView.alloc initWithImage:self.viewModel.image];
         _textField.leftViewMode = UITextFieldViewModeAlways;
         _textField.placeholder = self.viewModel.textModel.text;
         _textField.font = UIFontWeightRegularSize(14);
         _textField.placeholderFont = _textField.font;
         _textField.placeholderColor = JobsGrayColor;
         CGFloat placeholderHeight = [self jobsGetLabelWidthWithTitle:_textField.placeholder font:_textField.placeholderFont].height;
         CGFloat placeholderY = (JobsWidth(28) - placeholderHeight) / 2;
         _textField.drawPlaceholderInRect = CGRectMake(JobsWidth(52), placeholderY, [MSInputStyle3View viewSizeWithModel:nil].width - JobsWidth(32 + 100), JobsWidth(28));// OK
         _textField.editingRectForBounds = CGRectMake(JobsWidth(52), 0, [MSInputStyle3View viewSizeWithModel:nil].width - JobsWidth(32 + 12 + 100), JobsWidth(28));
         _textField.textRectForBounds = CGRectMake(JobsWidth(52), 0, [MSInputStyle3View viewSizeWithModel:nil].width - JobsWidth(32 + 12 + 100), 100);
         @jobs_weakify(self)
         [_textField jobsTextFieldEventFilterBlock:^BOOL(id data) {
 //            @jobs_strongify(self)
             return YES;
         } subscribeNextBlock:^(NSString * _Nullable x) {
             @jobs_strongify(self)
             [self textFieldBlock:self->_textField
                   textFieldValue:x];
         }];
         [self addSubview:_textField];
         [_textField mas_makeConstraints:^(MASConstraintMaker *make) {
             make.size.mas_equalTo(CGSizeMake([MSInputStyle3View viewSizeWithModel:nil].width - JobsWidth(32 + 12 + 100), JobsWidth(28)));
             make.centerY.equalTo(self);
             make.left.equalTo(self).offset(JobsWidth(12));
         }];
     }return _textField;
 }
 /// ÊêúÁ¥¢Ê°ÜÔºåleftView Âíå rightViewÈÉΩÂ≠òÂú®
 _searchBtn.size = CGSizeMake(JobsWidth(60), JobsWidth(32));

 -(ZYTextField *)textField{
     if (!_textField) {
         _textField = ZYTextField.new;
         _textField.delegate = self;
         _textField.backgroundColor = RGBA_COLOR(245, 245, 245, 1);
         _textField.returnKeyType = UIReturnKeyDefault;
         _textField.keyboardAppearance = UIKeyboardAppearanceDefault;
         _textField.keyboardType = UIKeyboardTypeDefault;
         _textField.leftView = [UIImageView.alloc initWithImage:JobsIMG(@"Êñ∞È¶ñÈ°µÁöÑÊêúÁ¥¢ÊîæÂ§ßÈïú")];
         _textField.leftViewMode = UITextFieldViewModeAlways;
         _textField.rightView = self.searchBtn;
         _textField.rightViewMode = UITextFieldViewModeAlways;
         _textField.placeholder = Internationalization(@"ÊêúÁ¥¢ÂÖ≥ÈîÆËØç");
         _textField.placeholderFont = UIFontWeightRegularSize(14);
         _textField.placeholderColor = JobsGrayColor;
         _textField.size = CGSizeMake(JobsWidth(220 - 80 - 12), JobsWidth(28));
         
         CGFloat placeholderHeight = [self jobsGetLabelWidthWithTitle:_textField.placeholder font:_textField.placeholderFont].height;
         CGFloat placeholderY = (_textField.size.height - placeholderHeight) / 2;
         CGFloat rightViewY = (_textField.size.height - self.searchBtn.size.height) / 2;
         
         _textField.drawPlaceholderInRect = CGRectMake(JobsWidth(32),// leftViewÁöÑÂÆΩ
                                                       placeholderY,// ÂûÇÁõ¥Â±Ö‰∏≠
                                                       [MSSearchView viewSizeWithModel:nil].width - JobsWidth(32 + 52),// 52ÊòØself.searchBtnÁöÑÂÆΩ
                                                       JobsWidth(28));//
         _textField.editingRectForBounds = CGRectMake(JobsWidth(32),
                                                      0,
                                                      [MSSearchView viewSizeWithModel:nil].width - JobsWidth(32 + 22 + 5) - self.searchBtn.size.width,// 5 ÊòØÂè≥Ëæπ‰∏éself.searchBtnÁöÑË∑ùÁ¶ª
                                                      JobsWidth(28));
         _textField.textRectForBounds = CGRectMake(JobsWidth(32),
                                                   0,
                                                   [MSSearchView viewSizeWithModel:nil].width - JobsWidth(32 + 22 + 5),// 5 ÊòØÂè≥Ëæπ‰∏éself.searchBtnÁöÑË∑ùÁ¶ª
                                                   100);// 100 Ëøô‰∏™ÂÄºÂÜôÊ≠ªÔºå‰∏çÁî®ÁÆ°
         _textField.rightViewRectForBounds = CGRectMake(JobsWidth([MSSearchView viewSizeWithModel:nil].width - self.searchBtn.size.width),
                                                        rightViewY,
                                                        self.searchBtn.size.width,
                                                        self.searchBtn.size.height);
         @jobs_weakify(self)
         [_textField jobsTextFieldEventFilterBlock:^BOOL(id data) {
 //            @jobs_strongify(self)
             return YES;
         } subscribeNextBlock:^(NSString * _Nullable x) {
             @jobs_strongify(self)
             [self textFieldBlock:self->_textField
                   textFieldValue:x];
         }];
         [self addSubview:_textField];
         [_textField mas_makeConstraints:^(MASConstraintMaker *make) {
             make.size.mas_equalTo(_textField.size);
             make.right.equalTo(self).offset(JobsWidth(-12));
             make.centerY.equalTo(self);
             make.left.equalTo(self).offset(JobsWidth(12));
         }];
     }return _textField;
 }
 */
